{% extends 'blog/blog.html' %}
{% load comment_tags %}
{% load likes_tags %}
{% load staticfiles %}
{% load highlight %}
{% load post_tags %}
{#页面标题#}
{% block title %}
    搜索结果
{% endblock title %}

{% block lunbobox %}{% endblock %}

{% block header_extend %}
    <link rel="stylesheet" href="{% static 'blog/css/blog.css' %}">
{% endblock %}
{% block nav_search_active %}active_tag{% endblock %}

{% block content %}
    {% if query %}

        <div class="container" style="margin-top: 2em">
            <div class="row">

                <div class="col-xs-12 col-sm-8 col-md-9">

                    {# post_list|length是一种过滤器,过滤的结果为post_list的长度 #}
                    {% for result in page.object_list %}
                        <div class="blog-border">
                            <div class="blog-item">
                                {# post.id把主键传递出去,在views中就可以找到该post的body,urls中也能规则匹配 #}{# 在反向解析中,注意格式{% url 'namespace:name' para %} #}
                                <div class="blog-title">
                                        <a href="{% url 'blog:detail' result.object.id %}">
                                            {% highlight result.object.title with query %}
                                        </a>
                                </div>

                                <div class="blog-describe">{{ result.object.body|cut:'&nbsp;'|striptags|truncatechars:150|safe}}</div>

                                <div>{#<span>中的是分类和时间logo样式#}
                                    <div class="blog-tags">

                                        <span class="glyphicon glyphicon-time"></span>&nbsp;{{ result.object.created_time|date:"Y-m-d" }}&nbsp;&nbsp;&nbsp;

                                        <a href="{% url 'blog:category' result.object.category.id %}">
                                            <span class="glyphicon glyphicon-file"></span>{{ result.object.category }}
                                        </a>&nbsp;&nbsp;&nbsp;

                                        阅读：{{ result.object.get_read_num }}&nbsp;&nbsp;&nbsp;

                                        评论：{% get_comment_count result.object %}&nbsp;&nbsp;&nbsp;

                                        推荐：<a onclick="likeChange(this, '{% get_content_type result.object %}', {{ result.object.id }})">
                                                <span class="glyphicon glyphicon-thumbs-up {% get_like_status result.object %}"></span>
                                                <span class="liked-num">{% get_like_count result.object %}</span>
                                             </a>
                                    </div>
                                </div>
                            </div>
                        </div>
                        {% empty %}
                            <div class="no-find">
                                很抱歉，没有检索您想要的内容，换个关键词再试试 ？
                                <div>
                                    <a href="{% url 'blog:home' %}">返回首页</a>
                                </div>
                            </div>
                        {% endfor %}
                </div>

                <div class="hidden-xs col-sm-4 col-md-3 blog-border">
                    <div class="side-list">
                                      <h4><span class="glyphicon glyphicon-fire"></span>&nbsp;热门阅读总榜</h4>
                                      <ul>
                                      {% for hot_data in all_hot_posts %}
                                      <div class="light-item">
                                      <a href="{% url 'blog:detail' hot_data.id %}" target="_Blank">{{ hot_data.title|striptags|truncatechars:30|safe }}</a>
                                      </div>
                                      {% empty %}
                                      暂无总榜 !
                                      {% endfor %}
                                      </ul>
                                      </div>

                    <div class="side-list">
                                      <h4><span class="glyphicon glyphicon-random"></span>&nbsp;&nbsp;随机推荐</h4>
                                      <ul>
                                      {% for post in random_recommend %}
                                      <li class="light-item">
                                      <a href="{% url 'blog:detail' post.id %}" target="_Blank">{{ post }}</a>
                                      </li>
                                      {% empty %}
                                      暂无推荐 !
                                      {% endfor %}
                                      </ul>
                                      </div>

                    <div class="side-list">
                                      <h4><span class="glyphicon glyphicon-time"></span>&nbsp;最新推荐</h4>
                                      <ul>
                                      {% for post in new_recommend %}
                                      <li class="light-item">
                                      <a href="{% url 'blog:detail' post.content_object.id %}" target="_Blank">{{ post.content_object.title }}</a>
                                      </li>
                                      {% empty %}
                                      暂无推荐 ！
                                      {% endfor %}
                                      </ul>
                                      </div>
                </div>

            </div>
        </div>
    {% endif %}
{% endblock %}

